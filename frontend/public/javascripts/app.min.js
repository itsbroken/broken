function updateCrawlSummary(e,t){var n={numCrawled:e,numBroken:t},r=document.getElementById("crawl-summary"),i="<p><b>{{numCrawled}}</b> URLs, <b>{{numBroken}}</b> broken links found</p>",o=Mustache.render(i,n);r.innerHTML=o}function updateBrokenLinkCard(e){var t=document.getElementById("broken-links"),n="<div id='broken-link-{{index}}' class='broken-link-data {{type}}'><p class='broken-link-url'><a href='{{link}}'>{{link}}</a></p><div class='broken-link-parents'><p>Found in the following pages:</p><ol>{{#parents}}<li><a href='{{.}}'>{{.}}</a></li>{{/parents}}</ol></div></div>";if(idString="broken-link-"+e.index,existingElem=document.getElementById(idString),existingElem){var r=Mustache.render("<li><a href='{{.}}'>{{.}}</a></li>",e.parents[0]);existingElem.getElementsByTagName("ol")[0].insertAdjacentHTML("beforeend",r)}else{var i=Mustache.render(n,e);t.insertAdjacentHTML("beforeend",i)}}function show(e){document.getElementById(e).className=document.getElementById(e).className.replace(/(?:^|\s)hidden(?!\S)/g,"")}function hide(e){document.getElementById(e).classList.add("hidden")}function reset(){hide("crawl-status"),hide("tick"),show("spinner");for(var e=document.getElementById("broken-links");e&&e.firstChild;)e.removeChild(e.firstChild)}function showOptions(){var e=document.getElementById("settings-path");optionsShown?(hide("crawl-options"),e.style.fill="",optionsShown=!1):(show("crawl-options"),e.style.fill="#41D3BD",optionsShown=!0)}function getOptions(){for(var e={},t=document.getElementsByName("accepted-urls"),n=document.getElementsByName("crawl-duration"),r=document.getElementsByName("media-types"),i=0,o=t.length;i<o;i++)if(t[i].checked){e.acceptedUrls=t[i].value;break}for(var i=0,o=n.length;i<o;i++)if(n[i].checked){e.crawlDuration=n[i].value;break}e.mediaTypes=[];for(var i=0,o=r.length;i<o;i++)r[i].checked&&e.mediaTypes.push(r[i].value);return e}var ws_proto="https:"==location.protocol?"wss://":"ws://",ws=new WebSocket(ws_proto+location.host+"/websocket"),crawling=!1;ws.onmessage=function(e){if(data=JSON.parse(e.data),"status"==data.response_type)"crawling"==data.status?(show("crawl-status"),hide("help-content")):"done"==data.status&&(hide("spinner"),show("tick"),crawling=!1);else if("update_counts"==data.response_type){var t=data.counts[0],n=data.counts[1];updateCrawlSummary(t,n)}else if("update_links"==data.response_type){var r=data.links[0];updateBrokenLinkCard(r)}};var optionsShown=!1;window.addEventListener("load",function(){var e=document.getElementById("url-form"),t=function(){document.getElementById("url").blur(),crawling||(crawling=!0,reset(),ws.send(JSON.stringify({url:document.getElementById("url").value,options:getOptions()})))};e.addEventListener("submit",function(e){e.preventDefault(),t()});var n=document.getElementById("url");if(n.addEventListener("keydown",function(e){13==e.keyCode&&(e.preventDefault(),t())}),n.addEventListener("input",function(){url=n.value,url.trim().startsWith("http://")||url.trim().startsWith("https://")||(url="http://"+url);var e=document.createElement("a");e.href=url;var t=e.protocol+"//"+e.host;""===n.value?(document.getElementById("accepted-urls-1-label").childNodes[2].textContent="Root URL",document.getElementById("accepted-urls-2-label").childNodes[2].textContent="Entire given URL"):(document.getElementById("accepted-urls-1-label").childNodes[2].textContent="Root URL: "+t,document.getElementById("accepted-urls-2-label").childNodes[2].textContent="Entire given URL: "+t+e.pathname)}),"createEvent"in document){var r=document.createEvent("HTMLEvents");r.initEvent("input",!1,!0),n.dispatchEvent(r)}else n.fireEvent("input");n.addEventListener("blur",function(){url=n.value,url.trim().startsWith("http://")||url.trim().startsWith("https://")||(url="http://"+url,n.value=url)});var i=document.getElementById("crawl-status"),o=e.offsetTop,s=!1;window.onscroll=function(e){var t=window.pageYOffset;!s&&t>=o?(s=!0,show("crawl-status-padding"),i.style.top="20px",i.style.zIndex="100",i.style.position="fixed",i.style.margin="0 auto"):s&&t<o&&(hide("crawl-status-padding"),s=!1,i.style.zIndex="97",i.style.position="static",i.style.margin="")}}),function(e,t){"object"==typeof exports&&exports&&"string"!=typeof exports.nodeName?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):(e.Mustache={},t(e.Mustache))}(this,function(e){function t(e){return"function"==typeof e}function n(e){return m(e)?"array":typeof e}function r(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function i(e,t){return null!=e&&"object"==typeof e&&t in e}function o(e,t){return g.call(e,t)}function s(e){return!o(v,e)}function a(e){return String(e).replace(/[&<>"'`=\/]/g,function(e){return w[e]})}function l(t,n){function i(){if(v&&!w)for(;g.length;)delete f[g.pop()];else g=[];v=!1,w=!1}function o(e){if("string"==typeof e&&(e=e.split(k,2)),!m(e)||2!==e.length)throw new Error("Invalid tags: "+e);a=new RegExp(r(e[0])+"\\s*"),l=new RegExp("\\s*"+r(e[1])),p=new RegExp("\\s*"+r("}"+e[1]))}if(!t)return[];var a,l,p,h=[],f=[],g=[],v=!1,w=!1;o(n||e.tags);for(var B,I,C,S,L,T,U=new d(t);!U.eos();){if(B=U.pos,C=U.scanUntil(a))for(var N=0,R=C.length;N<R;++N)S=C.charAt(N),s(S)?g.push(f.length):w=!0,f.push(["text",S,B,B+1]),B+=1,"\n"===S&&i();if(!U.scan(a))break;if(v=!0,I=U.scan(x)||"name",U.scan(y),"="===I?(C=U.scanUntil(E),U.scan(E),U.scanUntil(l)):"{"===I?(C=U.scanUntil(p),U.scan(b),U.scanUntil(l),I="&"):C=U.scanUntil(l),!U.scan(l))throw new Error("Unclosed tag at "+U.pos);if(L=[I,C,B,U.pos],f.push(L),"#"===I||"^"===I)h.push(L);else if("/"===I){if(T=h.pop(),!T)throw new Error('Unopened section "'+C+'" at '+B);if(T[1]!==C)throw new Error('Unclosed section "'+T[1]+'" at '+B)}else"name"===I||"{"===I||"&"===I?w=!0:"="===I&&o(C)}if(T=h.pop())throw new Error('Unclosed section "'+T[1]+'" at '+U.pos);return c(u(f))}function u(e){for(var t,n,r=[],i=0,o=e.length;i<o;++i)t=e[i],t&&("text"===t[0]&&n&&"text"===n[0]?(n[1]+=t[1],n[3]=t[3]):(r.push(t),n=t));return r}function c(e){for(var t,n,r=[],i=r,o=[],s=0,a=e.length;s<a;++s)switch(t=e[s],t[0]){case"#":case"^":i.push(t),o.push(t),i=t[4]=[];break;case"/":n=o.pop(),n[5]=t[2],i=o.length>0?o[o.length-1][4]:r;break;default:i.push(t)}return r}function d(e){this.string=e,this.tail=e,this.pos=0}function p(e,t){this.view=e,this.cache={".":this.view},this.parent=t}function h(){this.cache={}}var f=Object.prototype.toString,m=Array.isArray||function(e){return"[object Array]"===f.call(e)},g=RegExp.prototype.test,v=/\S/,w={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},y=/\s*/,k=/\s+/,E=/\s*=/,b=/\s*\}/,x=/#|\^|\/|>|\{|&|=|!/;d.prototype.eos=function(){return""===this.tail},d.prototype.scan=function(e){var t=this.tail.match(e);if(!t||0!==t.index)return"";var n=t[0];return this.tail=this.tail.substring(n.length),this.pos+=n.length,n},d.prototype.scanUntil=function(e){var t,n=this.tail.search(e);switch(n){case-1:t=this.tail,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,n),this.tail=this.tail.substring(n)}return this.pos+=t.length,t},p.prototype.push=function(e){return new p(e,this)},p.prototype.lookup=function(e){var n,r=this.cache;if(r.hasOwnProperty(e))n=r[e];else{for(var o,s,a=this,l=!1;a;){if(e.indexOf(".")>0)for(n=a.view,o=e.split("."),s=0;null!=n&&s<o.length;)s===o.length-1&&(l=i(n,o[s])),n=n[o[s++]];else n=a.view[e],l=i(a.view,e);if(l)break;a=a.parent}r[e]=n}return t(n)&&(n=n.call(this.view)),n},h.prototype.clearCache=function(){this.cache={}},h.prototype.parse=function(e,t){var n=this.cache,r=n[e];return null==r&&(r=n[e]=l(e,t)),r},h.prototype.render=function(e,t,n){var r=this.parse(e),i=t instanceof p?t:new p(t);return this.renderTokens(r,i,n,e)},h.prototype.renderTokens=function(e,t,n,r){for(var i,o,s,a="",l=0,u=e.length;l<u;++l)s=void 0,i=e[l],o=i[0],"#"===o?s=this.renderSection(i,t,n,r):"^"===o?s=this.renderInverted(i,t,n,r):">"===o?s=this.renderPartial(i,t,n,r):"&"===o?s=this.unescapedValue(i,t):"name"===o?s=this.escapedValue(i,t):"text"===o&&(s=this.rawValue(i)),void 0!==s&&(a+=s);return a},h.prototype.renderSection=function(e,n,r,i){function o(e){return s.render(e,n,r)}var s=this,a="",l=n.lookup(e[1]);if(l){if(m(l))for(var u=0,c=l.length;u<c;++u)a+=this.renderTokens(e[4],n.push(l[u]),r,i);else if("object"==typeof l||"string"==typeof l||"number"==typeof l)a+=this.renderTokens(e[4],n.push(l),r,i);else if(t(l)){if("string"!=typeof i)throw new Error("Cannot use higher-order sections without the original template");l=l.call(n.view,i.slice(e[3],e[5]),o),null!=l&&(a+=l)}else a+=this.renderTokens(e[4],n,r,i);return a}},h.prototype.renderInverted=function(e,t,n,r){var i=t.lookup(e[1]);if(!i||m(i)&&0===i.length)return this.renderTokens(e[4],t,n,r)},h.prototype.renderPartial=function(e,n,r){if(r){var i=t(r)?r(e[1]):r[e[1]];return null!=i?this.renderTokens(this.parse(i),n,r,i):void 0}},h.prototype.unescapedValue=function(e,t){var n=t.lookup(e[1]);if(null!=n)return n},h.prototype.escapedValue=function(t,n){var r=n.lookup(t[1]);if(null!=r)return e.escape(r)},h.prototype.rawValue=function(e){return e[1]},e.name="mustache.js",e.version="2.2.1",e.tags=["{{","}}"];var B=new h;e.clearCache=function(){return B.clearCache()},e.parse=function(e,t){return B.parse(e,t)},e.render=function(e,t,r){if("string"!=typeof e)throw new TypeError('Invalid template! Template should be a "string" but "'+n(e)+'" was given as the first argument for mustache#render(template, view, partials)');return B.render(e,t,r)},e.to_html=function(n,r,i,o){var s=e.render(n,r,i);return t(o)?void o(s):s},e.escape=a,e.Scanner=d,e.Context=p,e.Writer=h});